<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>Kazakh Smart Bot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0; padding: 0;
      font-family: Arial, sans-serif;
      background: #0d1f0d;
      color: #e0ffe0;
      display: flex; flex-direction: column;
      height: 100vh;
    }
    header {
      background: #133d13;
      padding: 15px; text-align: center;
      font-size: 20px; font-weight: bold;
      border-bottom: 2px solid #0f2f0f;
    }
    #chat {
      flex: 1; overflow-y: auto;
      padding: 15px;
    }
    .msg {
      margin: 8px 0;
      padding: 10px 14px;
      border-radius: 12px;
      max-width: 80%;
      line-height: 1.4em;
    }
    .user { background: #1f5d1f; margin-left: auto; }
    .bot { background: #144d14; margin-right: auto; }
    #input-area {
      display: flex;
      padding: 10px;
      background: #133d13;
      border-top: 2px solid #0f2f0f;
    }
    #input {
      flex: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
    }
    button {
      margin-left: 8px;
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      background: #1f5d1f;
      color: #fff;
      cursor: pointer;
    }
    button:hover { background: #267326; }
  </style>
</head>
<body>
  <header>Kazakh Smart Bot</header>
  <div id="chat"></div>

  <div id="input-area">
    <input id="input" type="text" placeholder="–°“±—Ä–∞“õ “õ–æ–π—ã“£—ã–∑...">
    <button onclick="sendMessage()">–ñ—ñ–±–µ—Ä—É</button>
    <input type="file" id="imageUpload" accept="image/*" style="display:none;" onchange="handleImage(this.files[0])">
    <button onclick="document.getElementById('imageUpload').click()">üì∑</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("input");

    function addMessage(text, sender="bot") {
      const div = document.createElement("div");
      div.className = "msg " + sender;
      div.innerText = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function sendMessage() {
      const text = input.value.trim();
      if (!text) return;
      addMessage(text, "user");
      input.value = "";
      await askGPT(text);
    }

    async function handleImage(file) {
      addMessage("üì∑ –°—É—Ä–µ—Ç ”©“£–¥–µ–ª—ñ–ø –∂–∞—Ç—ã—Ä...", "bot");
      const { data: { text } } = await Tesseract.recognize(file, 'kaz+eng+rus');
      addMessage("–°—É—Ä–µ—Ç—Ç–µ–Ω —Ç–∞–±—ã–ª“ì–∞–Ω –º”ô—Ç—ñ–Ω: " + text, "bot");
      await askGPT(text);
    }

    async function askGPT(question) {
      addMessage("–ñ–∞—É–∞–ø –æ–π–ª–∞–Ω—É–¥–∞...", "bot");

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer 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" // ‚Üê –æ—Å—ã–Ω–¥–∞ ”©–∑ API –∫—ñ–ª—Ç—ñ“£–¥—ñ “õ–æ–π
          },
          body: JSON.stringify({
            model: "gpt-4o-mini", // GPT-5 –Ω–µ–º–µ—Å–µ gpt-4o-mini –ø–∞–π–¥–∞–ª–∞–Ω—É“ì–∞ –±–æ–ª–∞–¥—ã
            messages: [
              { role: "system", content: "–°–µ–Ω “õ–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω–¥–µ —Å”©–π–ª–µ–π—Ç—ñ–Ω –∞“õ—ã–ª–¥—ã –∫”©–º–µ–∫—à—ñ—Å—ñ“£. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, —Ñ–∏–∑–∏–∫–∞, —Ö–∏–º–∏—è, –±–∏–æ–ª–æ–≥–∏—è –∂”ô–Ω–µ –±–∞—Å“õ–∞ –ø”ô–Ω–¥–µ—Ä –±–æ–π—ã–Ω—à–∞ —Å“±—Ä–∞“õ—Ç–∞—Ä“ì–∞ —Ç–æ–ª—ã“õ –∂–∞—É–∞–ø –±–µ—Ä–µ—Å—ñ“£." },
              { role: "user", content: question }
            ]
          })
        });
        const data = await response.json();
        const answer = data.choices[0].message.content;
        addMessage(answer, "bot");
      } catch (err) {
        addMessage("‚ö†Ô∏è “ö–∞—Ç–µ: " + err.message, "bot");
      }
    }
  </script>
</body>
</html>
